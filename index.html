<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Clickable Stopwatch</title>
<style>
    body {
        margin: 0;
        padding: 0;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background-color: black;
        color: white;
        font-family: 'Helvetica Neue', sans-serif;
        font-size: 10vw; /* ビューポートに応じたフォントサイズ */
        cursor: pointer;
        text-align: center;
        user-select: none; /* テキスト選択を無効に */
        transition: background-color 0.3s ease; /* 背景色の変化を滑らかに */
    }

    .running {
        background-color: darkred; /* 点灯時の背景色 */
    }
</style>
</head>
<body>

<div id="timer">00:00:00</div>

<script>
    const body = document.body;
    const timerDisplay = document.getElementById('timer');
    let startTime = 0;
    let elapsedTime = 0;
    let timerInterval;
    let timerState = 'stopped'; // 'stopped', 'running'

    // クリック判定用の変数を追加
    let clickTimeout = null;
    let clickCount = 0;

    function formatTime(ms) {
        let totalSeconds = Math.floor(ms / 1000);
        let hours = Math.floor(totalSeconds / 3600).toString().padStart(2, '0');
        let minutes = Math.floor((totalSeconds % 3600) / 60).toString().padStart(2, '0');
        let seconds = (totalSeconds % 60).toString().padStart(2, '0');
        return `${hours}:${minutes}:${seconds}`;
    }

    function startTimer() {
        if (timerState === 'running') return;
        startTime = Date.now() - elapsedTime;
        timerInterval = setInterval(() => {
            elapsedTime = Date.now() - startTime;
            timerDisplay.textContent = formatTime(elapsedTime);
        }, 1000);
        timerState = 'running';
        body.classList.add('running');
    }

    function stopTimer() {
        if (timerState === 'stopped') return;
        clearInterval(timerInterval);
        timerState = 'stopped';
        body.classList.remove('running');
    }

    function resetTimer() {
        stopTimer();
        elapsedTime = 0;
        timerDisplay.textContent = formatTime(0);
    }

    // クリックイベントの処理を修正
    body.addEventListener('click', () => {
        clickCount++;

        if (clickCount === 1) {
            // 1回目のクリックでは、少し待ってシングルクリックかダブルクリックか判定
            clickTimeout = setTimeout(() => {
                // 待っても2回目のクリックがなければ、シングルクリックと判定
                if (timerState === 'running') {
                    stopTimer();
                } else {
                    startTimer();
                }
                clickCount = 0; // カウントをリセット
            }, 250); // 250ミリ秒待つ
        } else if (clickCount === 2) {
            // 250ミリ秒以内に2回目のクリックがあれば、ダブルクリックと判定
            clearTimeout(clickTimeout); // シングルクリックの処理をキャンセル
            resetTimer(); // リセット処理を実行
            clickCount = 0; // カウントをリセット
        }
    });
</script>
</body>
</html>
